<div class="tetris-wrap textcenter">
  <h3>Play a quick game of Tetris while we load the next part</h3>
  <div class="tetris-controls">
    <div class="grid-item">
      <h2>Controls</h2>
    </div><!--
   --><div class="grid-item grid-1-3">
      <p>Move:</p>
    </div><!--
   --><div class="grid-item grid-2-3">
      <p><strong>Left</strong> and <strong>Right arrows</strong></p>
    </div><!--
   --><div class="grid-item grid-1-3">
      <p>Rotate Right:</p>
    </div><!--
   --><div class="grid-item grid-2-3">
      <p><strong>X</strong> or <strong>Up arrow</strong></p>
    </div><!--
   --><div class="grid-item grid-1-3">
      <p>Rotate Left:</p>
    </div><!--
   --><div class="grid-item grid-2-3">
      <p><strong>Z</strong></p>
    </div><!--
   --><div class="grid-item grid-1-3">
      <p>Drop:</p>
    </div><!--
   --><div class="grid-item grid-2-3">
      <p><strong>Spacebar</strong></p>
    </div>
  </div>

  <div class="collectorButton" id="reveal">Start</div>

  <div class="tetris">
    <embed src="http://www.cogfog.com/nblox.swf" menu="false" width="550" height="650"
           quality="high" type="application/x-shockwave-flash"
           pluginspage="http://www.macromedia.com/go/getflashplayer/" />
  </div>
</div>

<?php if (is_numeric($max_time)): ?>
<div class="stepout-clock">
  <span>Seconds remaining</span>
  <h3 class="countdown"></h3>
</div>

<?php else: ?>
<div class="textcenter">
  <button class="collectorButton collectorAdvance" id="FormSubmitButton">Next</button>
</div>
<?php endif; ?>

<script type="text/javascript">
trialBegin = function() {
    // get trial time from page and run timer
    var tetris_max_time = parseFloat($("#maxTime").html());
    COLLECTOR.timer(tetris_max_time - 5, function () {
        // hide game and show get ready prompt for 5 secs
        $(".stepout-clock").hide();
        $(".tetris-wrap")
            .removeClass("tetris-wrap")
            .html("<div class='action-bg textcenter fullPad'>" +
                      "<h1 class='pad'>Get ready to continue in ... </h1>" +
                      "<h1 id=getready></h1>" + 
                  "</div>");
        COLLECTOR.timer(5, function() {
            $('form').submit();
        }, $("#getready"));
    }, $(".countdown"));
}

// reveal on clicking start
$("#reveal").click(function() {
    $("#reveal").hide();
    $(".tetris").slideDown(400, function() {
        var off = $(".tetris").offset();
        $("html, body").animate({scrollTop: off.top}, 500);
    });
});
</script>